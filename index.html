<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APG Incident Classification Tool</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        .question-group {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .major {
            background-color: #ffebee;
            border: 2px solid #c62828;
        }
        .minor {
            background-color: #e8f5e9;
            border: 2px solid #2e7d32;
        }
        button {
            padding: 10px 20px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #1976D2;
        }
        .answer-list {
            margin-top: 10px;
        }
        .answer-list li {
            margin-bottom: 5px;
        }
        .positive {
            color: #2e7d32;
        }
        .negative {
            color: #c62828;
        }
        .rationale {
            margin-top: 10px;
        }
        textarea {
            width: 100%;
            height: 80px;
            margin-top: 5px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h2>APG Incident Classification Tool</h2>
    
    <div class="question-group">
        <h3>Question 1: Does the incident affect Critical Services?</h3>
        <p>Assess if the incident affects one of the below options:
            <br>a) affects or has affected ICT services or network and information systems that support critical or important functions of the financial entity;
            <br>b) affects or has affected financial services that require authorisation, registration or that are supervised by competent authorities; or
            <br>c) represents a successful, malicious and unauthorised access to the network and information systems of the financial entity.</p>
        <div>
            <label>
                <input type="radio" name="q1" value="yes" required> Yes - please continue with question 2
            </label>
            <br>
            <label>
                <input type="radio" name="q1" value="no" required> No - this means the incident is not a major incident and this does not require reporting to the competent authorities. You can stop with this questionnaire.
            </label>
        </div>
        <div class="rationale">
            <label for="q1-rationale">Rationale for your answer:</label>
            <textarea id="q1-rationale" name="q1-rationale" placeholder="Please provide rationale for your answer"></textarea>
        </div>
    </div>

    <div class="question-group">
        <h3>Question 2: Is there a security breach?</h3>
        <p>Is unauthorised access to network and information systems identified, which may result in data losses?</p>
        <div>
            <label>
                <input type="radio" name="q2" value="yes" required> Yes
            </label>
            <br>
            <label>
                <input type="radio" name="q2" value="no" required> No
            </label>
        </div>
        <div class="rationale">
            <label for="q2-rationale">Rationale for your answer:</label>
            <textarea id="q2-rationale" name="q2-rationale" placeholder="Please provide rationale for your answer"></textarea>
        </div>
    </div>

    <div class="question-group">
        <h3>Additional Impact Assessment Questions</h3>
        <div>
            <h3>Question 3A: Affected Clients, financial counterparts and transactions</h3>
            <p>Does the incident meet any of the following conditions?
                <br>a) the number of affected clients is higher than 10% of all clients using the affected service; or
                <br>b) the number of affected clients is higher than 100,000 clients using the affected service; or
                <br>c) the number of affected financial counterparts is higher than 30% of all financial counterparts carrying out activities related to the provision of the affected service; or
                <br>d) the number of affected transactions is higher than 10% of the daily average number of transactions carried out by the financial entity related to the affected service; or
                <br>e) the amount of affected transactions is higher than 10% of the daily average value of transactions carried out by the financial entity related to the affected service; or
                <br>f) any identified impact on clients or financial counterparts which have been identified as relevant as an outcome of the assessment made by the financial entity under Article 1(3).</p>
            <label>
                <input type="radio" name="q3a" value="yes" required> Yes
            </label>
            <br>
            <label>
                <input type="radio" name="q3a" value="no" required> No
            </label>
            <div class="rationale">
                <label for="q3a-rationale">Rationale for your answer:</label>
                <textarea id="q3a-rationale" name="q3a-rationale" placeholder="Please provide rationale for your answer"></textarea>
            </div>
        </div>
        <div>
            <h3>Question 3B: Data losses</h3>
            <p>Does the incident have any impact on the availability, authenticity, integrity or confidentiality of data, which has or will have an adverse impact on the implementation of the business objectives of the Financial Entity or on meeting regulatory requirements?</p>
            <label>
                <input type="radio" name="q3b" value="yes" required> Yes
            </label>
            <br>
            <label>
                <input type="radio" name="q3b" value="no" required> No
            </label>
            <div class="rationale">
                <label for="q3b-rationale">Rationale for your answer:</label>
                <textarea id="q3b-rationale" name="q3b-rationale" placeholder="Please provide rationale for your answer"></textarea>
            </div>
        </div>
        <!-- Repeat rationale sections for 3C, 3D, 3E, and 3F -->
        <div>
            <h3>Question 3C: Reputational impact</h3>
            <label>
                <input type="radio" name="q3c" value="yes" required> Yes
            </label>
            <br>
            <label>
                <input type="radio" name="q3c" value="no" required> No
            </label>
            <div class="rationale">
                <label for="q3c-rationale">Rationale for your answer:</label>
                <textarea id="q3c-rationale" name="q3c-rationale" placeholder="Please provide rationale for your answer"></textarea>
            </div>
        </div>
        <!-- Remaining questions (3D, 3E, 3F) follow the same structure -->
        <div>
            <h3>Question 3D: Duration and Service Downtime</h3>
            <label>
                <input type="radio" name="q3d" value="yes" required> Yes
            </label>
            <br>
            <label>
                <input type="radio" name="q3d" value="no" required> No
            </label>
            <div class="rationale">
                <label for="q3d-rationale">Rationale for your answer:</label>
                <textarea id="q3d-rationale" name="q3d-rationale" placeholder="Please provide rationale for your answer"></textarea>
            </div>
        </div>
        <div>
            <h3>Question 3E: Geographical Spread</h3>
            <label>
                <input type="radio" name="q3e" value="yes" required> Yes
            </label>
            <br>
            <label>
                <input type="radio" name="q3e" value="no" required> No
            </label>
            <div class="rationale">
                <label for="q3e-rationale">Rationale for your answer:</label>
                <textarea id="q3e-rationale" name="q3e-rationale" placeholder="Please provide rationale for your answer"></textarea>
            </div>
        </div>
        <div>
            <h3>Question 3F: Economic Impact</h3>
            <label>
                <input type="radio" name="q3f" value="yes" required> Yes
            </label>
            <br>
            <label>
                <input type="radio" name="q3f" value="no" required> No
            </label>
            <div class="rationale">
                <label for="q3f-rationale">Rationale for your answer:</label>
                <textarea id="q3f-rationale" name="q3f-rationale" placeholder="Please provide rationale for your answer"></textarea>
            </div>
        </div>
    </div>

    <button onclick="classifyIncident()">Classify Incident</button>

    <div id="result" class="result"></div>

    <script>
    function classifyIncident() {
        // Check if all questions are answered
        const allQuestions = ['q1', 'q2', 'q3a', 'q3b', 'q3c', 'q3d', 'q3e', 'q3f'];
        for (let q of allQuestions) {
            if (!document.querySelector(`input[name="${q}"]:checked`)) {
                alert('Please answer all questions before classification.');
                return;
            }
        }

        // Get answers
        const getAnswer = (name) => document.querySelector(`input[name="${name}"]:checked`).value === 'yes';
        
        const q1 = getAnswer('q1');
        const q2 = getAnswer('q2');
        const q3Answers = {
            a: getAnswer('q3a'),
            b: getAnswer('q3b'),
            c: getAnswer('q3c'),
            d: getAnswer('q3d'),
            e: getAnswer('q3e'),
            f: getAnswer('q3f')
        };

        // Count positive Q3 answers
        const q3PositiveCount = Object.values(q3Answers).filter(v => v).length;

        // Determine classification - if Q1 is no, always non-major regardless of other answers
        const isMajor = q1 && ((q1 && q2) || q3PositiveCount >= 2);

        // Generate result
        const resultDiv = document.getElementById('result');
        resultDiv.style.display = 'block';
        
        let resultHTML = `
            <h3>${isMajor ? 'MAJOR' : 'NON-MAJOR'} Incident</h3>
            <p>Classification based on the following answers:</p>
            <ul class="answer-list">
                <li class="${q1 ? 'positive' : 'negative'}">
                    Q1 - Critical functions/services affected: ${q1 ? 'YES' : 'NO'}
                </li>
                <li class="${q2 ? 'positive' : 'negative'}">
                    Q2 - Unauthorized access identified: ${q2 ? 'YES' : 'NO'}
                </li>
                <li class="${q3Answers.a ? 'positive' : 'negative'}">
                    Q3A - Client/transaction impact: ${q3Answers.a ? 'YES' : 'NO'}
                </li>
                <li class="${q3Answers.b ? 'positive' : 'negative'}">
                    Q3B - Data impact: ${q3Answers.b ? 'YES' : 'NO'}
                </li>
                <li class="${q3Answers.c ? 'positive' : 'negative'}">
                    Q3C - Reputational impact: ${q3Answers.c ? 'YES' : 'NO'}
                </li>
                <li class="${q3Answers.d ? 'positive' : 'negative'}">
                    Q3D - Duration/downtime impact: ${q3Answers.d ? 'YES' : 'NO'}
                </li>
                <li class="${q3Answers.e ? 'positive' : 'negative'}">
                    Q3E - Geographical impact: ${q3Answers.e ? 'YES' : 'NO'}
                </li>
                <li class="${q3Answers.f ? 'positive' : 'negative'}">
                    Q3F - Economic impact: ${q3Answers.f ? 'YES' : 'NO'}
                </li>
            </ul>
            <p><strong>Classification Reason:</strong></p>
            <ul>
                ${!q1 ? '<li>Q1 is negative - automatically classified as non-major</li>' : ''}
                ${(q1 && q2) ? '<li>Q1 and Q2 are both positive</li>' : ''}
                ${(q1 && q3PositiveCount >= 2) ? `<li>${q3PositiveCount} positive answers in Q3 section (2 or more required for major classification)</li>` : ''}
                ${(!isMajor && q1) ? '<li>Insufficient criteria met for major classification</li>' : ''}
            </ul>
        `;

        resultDiv.className = `result ${isMajor ? 'major' : 'minor'}`;
        resultDiv.innerHTML = resultHTML;
    }
</script>
</body>
</html>
